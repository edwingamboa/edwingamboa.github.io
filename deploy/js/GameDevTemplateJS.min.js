/*! GameDevTemplateJS 0.0.1 | (c) 2013 Thomas Viktil */ 
function preload(){game.load.image("sky","assets/images/sky.png"),game.load.image("ground","assets/images/platform.png"),game.load.image("star","assets/images/star.png"),game.load.spritesheet("character","assets/sprites/character.png",32,48);for(var a=1;2>=a;a++)game.load.image("bullet"+a,"assets/images/bullet"+a+".png");game.stage.backgroundColor="#82CAFA"}function create(){game.world.setBounds(0,0,3e3,600),game.physics.startSystem(Phaser.Physics.ARCADE),weapons.push(new Weapon(30,"bullet1",0,400,100)),weapons.push(new Weapon(40,"bullet2",0,500,100)),currentWeapon=0;for(var a=1;a<weapons.length;a++)weapons[a].visible=!1;platforms=game.add.group(),platforms.enableBody=!0;var b=platforms.create(0,game.world.height-64,"ground");b.scale.setTo(10,2),b.body.immovable=!0;var c=platforms.create(400,400,"ground");c.body.immovable=!0,c=platforms.create(-150,250,"ground"),c.body.immovable=!0,player=game.add.sprite(32,game.world.height-150,"character"),game.physics.arcade.enable(player),player.body.bounce.y=.2,player.body.gravity.y=300,player.body.collideWorldBounds=!0,player.animations.add("left",[0,1,2,3],10,!0),player.animations.add("right",[5,6,7,8],10,!0),stars=game.add.group(),stars.enableBody=!0;for(var a=0;12>a;a++){var d=stars.create(70*a,0,"star");d.body.gravity.y=300,d.body.bounce.y=.7+.2*Math.random()}scoreText=game.add.text(game.camera.width-300,16,"Score: 0",{fontSize:"32px",fill:"#000"}),scoreText.fixedToCamera=!0,ammoText=game.add.text(game.camera.width-300,game.world.height-50,"Ammo: 0",{fontSize:"32px",fill:"#000"}),ammoText.fixedToCamera=!0,healthLevelText=game.add.text(16,16,"Health: 100",{fontSize:"32px",fill:"#000"}),healthLevelText.fixedToCamera=!0,cursors=game.input.keyboard.createCursorKeys();var e=this.input.keyboard.addKey(Phaser.Keyboard.ENTER);e.onDown.add(nextWeapon,this),game.renderer.renderSession.roundPixels=!0,game.camera.follow(player)}function update(){game.physics.arcade.collide(player,platforms),game.physics.arcade.collide(stars,platforms),game.physics.arcade.overlap(player,stars,collectStar,null,this),player.body.velocity.x=0,cursors.left.isDown?(xDirection=-1,game.input.keyboard.isDown(Phaser.Keyboard.X)?player.body.velocity.x=-playerAcceleration:player.body.velocity.x=-playerVelocity,player.animations.play("left")):cursors.right.isDown?(xDirection=1,game.input.keyboard.isDown(Phaser.Keyboard.X)?player.body.velocity.x=playerAcceleration:player.body.velocity.x=playerVelocity,player.animations.play("right")):(player.animations.stop(),player.frame=4),cursors.up.isDown&&player.body.touching.down&&(player.body.velocity.y=-350),cursors.up.isDown&&player.body.touching.down&&(player.animations.stop(),player.frame=9),game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&weapons[currentWeapon].fire()}function nextWeapon(){currentWeapon++,currentWeapon===weapons.length&&(currentWeapon=0),weapons[currentWeapon].visible=!0,ammo=weapons[currentWeapon].numberOfBullets,ammoText.text="Ammo: "+ammo}function collectStar(a,b){b.kill(),score+=10,scoreText.text="Score: "+score}function render(){game.debug.cameraInfo(game.camera,32,32)}var game=new Phaser.Game(1200,600,Phaser.AUTO,"game",{preload:preload,create:create,update:update,render:render}),player,platforms,cursors,playerVelocity=250,playerAcceleration=500,stars,score=0,ammo=10,healthLevel=100,scoreText,ammoText,healthLevelText,weapons=[],currentWeapon=0,xDirection=1,Weapon={},Weapon=function(a,b,c,d,e){this.numberOfBullets=a,this.bullets=game.add.group(),this.bullets.enableBody=!0,this.bullets.physicsBodyType=Phaser.Physics.ARCADE,this.bullets.createMultiple(a,b),this.nextFire=c,this.bulletSpeed=d,this.fireRate=e,this.bullets.setAll("anchor.x",.5),this.bullets.setAll("anchor.y",1),this.bullets.setAll("outOfBoundsKill",!0),this.bullets.setAll("checkWorldBounds",!0),this.bullets.setAll("texture.baseTexture.scaleMode",PIXI.scaleModes.NEAREST),this.bullets.setAll("exists",!1)};Weapon.prototype.constructor=Weapon,Weapon.prototype.fire=function(){game.time.now>this.nextFire&&(currentBullet=this.bullets.getFirstExists(!1),currentBullet&&this.numberOfBullets>0&&(currentBullet.reset(player.x,player.y+30),currentBullet.body.velocity.x=player.body.velocity.x+this.bulletSpeed*xDirection,this.nextFire=game.time.now+this.fireRate,this.numberOfBullets--,ammo=this.numberOfBullets,ammoText.text="Ammo: "+ammo))};